webpackJsonp([2],{298:function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{sideBarStatus:e.sideBarToggle,settingStatus:e.settingStatus,currentFilters:e.currentFilters,tagScrollPos:e.tagScrollPos}}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),c=t(1),u=n(c),l=(t(220),t(171)),p=(t(281),t(285)),f=t(299),d=n(f),h=t(287),y=t(294),g=function(e){function t(){o(this,t);var e=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={filters:[{index:0,name:"全部",on:!0,callBack:function(t){return e.refreshList(t)}},{index:1,name:"系统预设",key:"type",value:0,callBack:function(t){return e.refreshList(t)}},{index:2,name:"自定义",key:"type",value:1,callBack:function(t){return e.refreshList(t)}},{index:3,name:"博文生成",key:"type",value:2,callBack:function(t){return e.refreshList(t)}}],toolBar:[{type:"link",name:"新增",icon:"iconfont icon-add",callBack:"/tags/edit"},{type:"reducer",name:"设置",icon:"iconfont icon-settings",callBack:"toggleSetting"}],list:[],typeList:[]},e}return s(t,e),a(t,[{key:"refreshList",value:function(e){var t=this,n={};this.props.currentFilters.forEach(function(t,o){t.index===e&&t.key&&(n[t.key.toLowerCase()]=t.value)}),this.props.dispatch((0,h.setTagScrollPos)(document.body.scrollTop)),this.props.dispatch((0,y.fetchGets)("/tag/page",n,function(e){t.setState({list:e})},"TagList"))}},{key:"deleteTag",value:function(e){var t=this;this.props.dispatch((0,h.setConfirmDialog)({title:"确认删除？",confirmCallback:function(){t.props.dispatch((0,h.closeConfirmDialog)()),p.Tool.get("/token").then(function(n){p.Tool.post("/tag/remove/"+e,{token:n.token}).then(function(e){t.props.dispatch((0,h.showMessage)({type:0===e.code?"success":"warn",text:e.msg})),0===e.code&&t.refreshList()}).catch(function(e){t.props.dispatch((0,h.showMessage)({type:"danger",text:"网络错误，请稍后重试"}))})}).catch(function(e){t.props.dispatch((0,h.showMessage)({type:"danger",text:"网络错误，请稍后重试"}))})}}))}},{key:"componentWillMount",value:function(){var e=this;this.props.dispatch((0,h.changeMenu)(2)),this.props.dispatch((0,h.setFilters)(this.state.filters)),this.props.dispatch((0,h.setToolBar)(this.state.toolBar)),this.props.dispatch((0,y.fetchGets)("/tag_type/list",{},function(t){e.setState({typeList:t})},"TypeList")),this.refreshList()}},{key:"tagPropChange",value:function(e,t){var n=this;this.props.dispatch((0,h.setConfirmDialog)({title:"确认修改属性？",confirmCallback:function(){n.props.dispatch((0,h.closeConfirmDialog)()),p.Tool.get("/token").then(function(o){var r={token:o.token};p.Tool.post(t+"/"+e,r).then(function(e){n.props.dispatch((0,h.showMessage)({type:0===e.code?"success":"warn",text:e.msg})),0===e.code&&n.refreshList()}).catch(function(e){n.props.dispatch((0,h.showMessage)({type:"danger",text:"网络错误，请稍后重试"}))})}).catch(function(e){n.props.dispatch((0,h.showMessage)({type:"danger",text:"网络错误，请稍后重试"}))})}}))}},{key:"componentDidUpdate",value:function(){document.body.scrollTop=this.props.tagScrollPos}},{key:"componentWillUnmount",value:function(){this.props.dispatch((0,h.setTagScrollPos)(document.body.scrollTop))}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{className:this.props.sideBarStatus?"tag-container wide":"tag-container"},this.state.list.map(function(t,n){return u.default.createElement(d.default,{key:t._id,tag:t,typeList:e.state.typeList,onDelete:function(t){return e.deleteTag(t)},propChange:function(t,n){return e.tagPropChange(t,n)},settingStatus:e.props.settingStatus})}))}}]),t}(c.Component);g.propTypes={sideBarStatus:c.PropTypes.bool.isRequired,settingStatus:c.PropTypes.bool.isRequired,currentFilters:c.PropTypes.array.isRequired,tagScrollPos:c.PropTypes.number.isRequired},exports.default=(0,l.connect)(i)(g)},299:function(e,exports,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=t(1),c=n(a),u=t(220),l=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),i(t,[{key:"render",value:function(){var e=this.props,t=e.tag,n=e.settingStatus,o=(e.propChange,e.onDelete);return c.default.createElement("div",{className:"tag-item"+(n?" hover":"")},c.default.createElement("i",{className:"iconfont icon-tag"}),c.default.createElement("h4",null,t.name),c.default.createElement("span",null,this.props.typeList.map(function(e,n){return e.key===t.type?e.name:null})),0!==t.type?c.default.createElement(u.Link,{to:"/tags/edit/"+t._id},c.default.createElement("div",{className:"tag-edit"},c.default.createElement("i",{className:"iconfont icon-write"}))):null,0!==t.type?c.default.createElement("div",{className:"tag-delete",onClick:function(){return o(t._id)}},c.default.createElement("i",{className:"iconfont icon-delete"})):null)}}]),t}(a.Component);exports.default=l,l.propTypes={tag:a.PropTypes.object.isRequired,settingStatus:a.PropTypes.bool.isRequired,propChange:a.PropTypes.func.isRequired,onDelete:a.PropTypes.func.isRequired,typeList:a.PropTypes.array.isRequired}}});
//# sourceMappingURL=Tags.js.map